---
title: Grant negotiation and authorization
---

<mark>To do (maybe not all on the same page)</mark>* How do you run your own AS *
How does the key registry work with the AS * How does the AS talk to the RS * What
are the introspection points between the RS and AS * What is an identity server *
How does that work with the AS * Initiating a GNAP interaction with the AS?

<hr />

Before a client can issue payment instructions for incoming payments, quotes, or outgoing payments, it must obtain a grant. Open Payments leverages the Grant Negotiation and Authorization Protocol (GNAP) to define a standard mechanism for clients to obtain grants.

[GNAP](https://datatracker.ietf.org/doc/html/draft-ietf-gnap-core-protocol) is a protocol developed at the IETF as the successor to OAuth 2.0, designed to fill many of the gaps discovered through the use of OAuth in Open Banking and other financial use cases.

## Grants

GNAP allows a client instance to request delegated authorization to protected resources from a party other than the end user. This delegation is facilitated by an authorization server, which exposes APIs compliant with the GNAP standard. The process by which the delegation occurs is known as a grant.

### Grant requests

In Open Payments, the client must <mark>[request a grant]()</mark> before calling the Open Payments API to create an <mark>[incoming payment]()</mark>, <mark>[outgoing payment]()</mark>, and/or <mark>[quote]()</mark>. A client can request a single grant for each one, but not for multiples of each. For example, a client can request a single grant for an incoming and outgoing payment, but not for two incoming payments.

The authorization server is uniquely identified by its grant endpoint URI, which is an absolute URI where clients start grant requests. A successfully issued grant results in the client receiving an access token. The access token:

- represents the rights granted to the client
- acts as credentials when calling a resource server's Open Payments API
- allows the client to access protected resources on the resource server and perform operations on these resources

In Open Payments, the ASE is the resource server and the OP-enabled account is the primary resource. An open-source implementation of an Open Payments resource server, called [Rafiki](https://rafiki.dev), is currently in development.

:::note
The authorization of access to an OP-enabled account can be separated from the ASE if desired. The authorization service can even be fulfilled by multiple federated providers if a use case requires this in the future.
:::

### Grant continuation and cancellation

The client can issue a <mark>[grant continuation request]()</mark> if a grant needs to be modified or continued. For example, a client may initially need read access to a resource, but later require write access. The client can request to <mark>[cancel a grant]()</mark> if it no longer needs access to protected resources on the resource server. Clients can also <mark>[rotate]()</mark> and <mark>[revoke]()</mark> access tokens.
